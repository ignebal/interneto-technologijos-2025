{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Music Platform Schema",
    "description": "Schema for a music platform JSON file",

    "type": "object",
    "properties": {
        "music_platform": {
            "type": "object",
            "properties": {
                "name": { "type": "string" },
                "founder": { "type": "string" },
                "founded_year": {
                    "type": "string",
                    "pattern": "^(19|20)\\d{2}$"
                },
                "subscription_price": {
                    "oneOf": [
                        {
                            "type": "object",
                            "properties": {
                                "currency": { "type": "string", "minLength": 3 },
                                "value": { "type": "number", "minimum": 0 }
                            },
                            "required": ["currency", "value"]
                        },
                        {
                            "type": "number",
                            "minimum": 0
                        }
                    ]
                },
                "artists": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                        "$ref": "#/definitions/artist"
                    }
                }
            },
            "required": ["name", "founded_year", "artists"]
        }
    },
    "required": ["music_platform"],

    "definitions": {
        "baseEntity": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier, e.g., ar001, al001",
                    "pattern": "^[a-z]{2}\\d{3}$"
                }
            },
            "required": ["id"]
        },
        "song": {
            "type": "object",
            "properties": {
                "track_number": { "type": "string" },
                "title": { "type": "string" },
                "genre": { "type": "string" },
                "duration": {
                    "type": "string",
                    "description": "Song duration in M:SS or MM:SS format",
                    "pattern": "^\\d{1,2}:\\d{2}$"
                }
            },
            "required": ["track_number", "title", "genre", "duration"]
        },
        "album": {
            "allOf": [
                { "$ref": "#/definitions/baseEntity" },
                {
                    "type": "object",
                    "properties": {
                        "title": { "type": "string" },
                        "type": {
                            "type": "string",
                            "enum": ["Album", "Mini-album", "Single", "EP"]
                        },
                        "release_date": {
                            "type": "string",
                            "format": "date"
                        },
                        "song_number": {
                            "type": "string",
                            "pattern": "^[1-9][0-9]*$"
                        },
                        "songs": {
                            "type": "array",
                            "minItems": 1,
                            "items": {
                                "$ref": "#/definitions/song"
                            }
                        }
                    },
                    "required": ["title", "type", "release_date", "song_number", "songs"]
                }
            ]
        },
        "artist": {
            "allOf": [
                { "$ref": "#/definitions/baseEntity" },
                {
                    "type": "object",
                    "properties": {
                        "name": { "type": "string" },
                        "home_country": { "type": "string" },
                        "debut_year": {
                            "type": "string",
                            "pattern": "^(19|20)\\d{2}$"
                        },
                        "albums": {
                            "type": "array",
                            "minItems": 1,
                            "items": {
                                "$ref": "#/definitions/album"
                            }
                        }
                    },
                    "required": ["name", "albums"]
                }
            ]
        }
    }
}